{"ast":null,"code":"import _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport { StatusBar } from 'expo-status-bar';\nimport { SafeAreaProvider } from 'react-native-safe-area-context';\nimport React, { useState, useEffect } from 'react';\nimport useCachedResources from \"./hooks/useCachedResources\";\nimport Navigation from \"./navigation\";\nimport Authorize from \"./components/Authorize\";\nimport AsyncStorage from '@react-native-async-storage/async-storage';\nimport { Provider } from 'react-redux';\nimport { createStore } from 'redux';\nimport rootReducer from \"./reducers\";\nimport Utils from \"./utils\";\nimport CONSTS from \"./constants\";\nimport { setUserInfo } from \"./actions\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nvar store = createStore(rootReducer);\nexport default function App() {\n  var isLoadingComplete = useCachedResources();\n  var onAgree = function () {\n    var _ref = _asyncToGenerator(function* () {\n      var authorize = yield AsyncStorage.setItem('Authorize', \"1\");\n      setShow(true);\n    });\n    return function onAgree() {\n      return _ref.apply(this, arguments);\n    };\n  }();\n  var _useState = useState(false),\n    _useState2 = _slicedToArray(_useState, 2),\n    show = _useState2[0],\n    setShow = _useState2[1];\n  useEffect(function () {\n    var init = function () {\n      var _ref2 = _asyncToGenerator(function* () {\n        var authorize = yield AsyncStorage.getItem('Authorize');\n        console.log(\"当前authorize状态:\", authorize);\n        if (authorize == 1) {\n          setShow(true);\n        }\n        var userInfo = yield Utils.getStorage(CONSTS.USER_INFO);\n        console.log(\"====userInfo from app cache=====\", userInfo);\n        store.dispatch(setUserInfo({\n          userInfo: userInfo\n        }));\n      });\n      return function init() {\n        return _ref2.apply(this, arguments);\n      };\n    }();\n    init();\n  }, []);\n  if (!isLoadingComplete) {\n    return null;\n  } else {\n    return _jsx(Provider, {\n      store: store,\n      children: _jsxs(SafeAreaProvider, {\n        children: [!show && _jsx(Authorize, {\n          onAgree: onAgree\n        }), show && _jsxs(_Fragment, {\n          children: [_jsx(Navigation, {}), _jsx(StatusBar, {})]\n        })]\n      })\n    });\n  }\n}","map":{"version":3,"names":["StatusBar","SafeAreaProvider","React","useState","useEffect","useCachedResources","Navigation","Authorize","AsyncStorage","Provider","createStore","rootReducer","Utils","CONSTS","setUserInfo","store","App","isLoadingComplete","onAgree","authorize","setItem","setShow","show","init","getItem","console","log","userInfo","getStorage","USER_INFO","dispatch"],"sources":["/Users/yori/Documents/project/gucci/App.tsx"],"sourcesContent":["import { StatusBar } from 'expo-status-bar';\nimport { SafeAreaProvider } from 'react-native-safe-area-context';\nimport React, { useState, useEffect } from 'react';\nimport useCachedResources from './hooks/useCachedResources';\nimport useColorScheme from './hooks/useColorScheme';\nimport Navigation from './navigation';\nimport Authorize from './components/Authorize'\nimport AsyncStorage from '@react-native-async-storage/async-storage';\nimport { Text, View } from './components/Themed';\nimport { Provider } from 'react-redux'\nimport { createStore } from 'redux'\nimport rootReducer from './reducers'\nimport Utils from './utils'\nimport CONSTS from './constants'\nimport {setToken, setUserInfo} from './actions'\n\nconst store = createStore(rootReducer)\n\nexport default function App() {\n  const isLoadingComplete = useCachedResources();\n\n  const onAgree = async()=>{\n    const authorize = await AsyncStorage.setItem('Authorize', \"1\");\n    setShow(true);\n  }\n\n  const [show, setShow] = useState(false);\n  useEffect(()=>{\n\n    const init = async ()=>{\n      const authorize = await AsyncStorage.getItem('Authorize');\n      console.log(\"当前authorize状态:\", authorize)\n      if(authorize == 1){\n        setShow(true)\n      }\n\n      const userInfo = await Utils.getStorage(CONSTS.USER_INFO);\n      console.log(\"====userInfo from app cache=====\", userInfo);\n      store.dispatch(setUserInfo({\n        userInfo\n      }))\n    }\n\n    init();\n  \n  }, [])\n\n  if (!isLoadingComplete) {\n    return null;\n  } else {\n    return (\n      <Provider store={store}>\n        <SafeAreaProvider>\n          { !show && <Authorize onAgree={onAgree}></Authorize>}\n          { show && <>\n              <Navigation/>\n              <StatusBar />\n            </>\n          }\n        </SafeAreaProvider>\n      </Provider>\n    );\n  }\n}\n"],"mappings":";;AAAA,SAASA,SAAS,QAAQ,iBAAiB;AAC3C,SAASC,gBAAgB,QAAQ,gCAAgC;AACjE,OAAOC,KAAK,IAAIC,QAAQ,EAAEC,SAAS,QAAQ,OAAO;AAClD,OAAOC,kBAAkB;AAEzB,OAAOC,UAAU;AACjB,OAAOC,SAAS;AAChB,OAAOC,YAAY,MAAM,2CAA2C;AAEpE,SAASC,QAAQ,QAAQ,aAAa;AACtC,SAASC,WAAW,QAAQ,OAAO;AACnC,OAAOC,WAAW;AAClB,OAAOC,KAAK;AACZ,OAAOC,MAAM;AACb,SAAkBC,WAAW;AAAkB;AAAA;AAAA;AAE/C,IAAMC,KAAK,GAAGL,WAAW,CAACC,WAAW,CAAC;AAEtC,eAAe,SAASK,GAAG,GAAG;EAC5B,IAAMC,iBAAiB,GAAGZ,kBAAkB,EAAE;EAE9C,IAAMa,OAAO;IAAA,6BAAG,aAAS;MACvB,IAAMC,SAAS,SAASX,YAAY,CAACY,OAAO,CAAC,WAAW,EAAE,GAAG,CAAC;MAC9DC,OAAO,CAAC,IAAI,CAAC;IACf,CAAC;IAAA,gBAHKH,OAAO;MAAA;IAAA;EAAA,GAGZ;EAED,gBAAwBf,QAAQ,CAAC,KAAK,CAAC;IAAA;IAAhCmB,IAAI;IAAED,OAAO;EACpBjB,SAAS,CAAC,YAAI;IAEZ,IAAMmB,IAAI;MAAA,8BAAG,aAAU;QACrB,IAAMJ,SAAS,SAASX,YAAY,CAACgB,OAAO,CAAC,WAAW,CAAC;QACzDC,OAAO,CAACC,GAAG,CAAC,gBAAgB,EAAEP,SAAS,CAAC;QACxC,IAAGA,SAAS,IAAI,CAAC,EAAC;UAChBE,OAAO,CAAC,IAAI,CAAC;QACf;QAEA,IAAMM,QAAQ,SAASf,KAAK,CAACgB,UAAU,CAACf,MAAM,CAACgB,SAAS,CAAC;QACzDJ,OAAO,CAACC,GAAG,CAAC,kCAAkC,EAAEC,QAAQ,CAAC;QACzDZ,KAAK,CAACe,QAAQ,CAAChB,WAAW,CAAC;UACzBa,QAAQ,EAARA;QACF,CAAC,CAAC,CAAC;MACL,CAAC;MAAA,gBAZKJ,IAAI;QAAA;MAAA;IAAA,GAYT;IAEDA,IAAI,EAAE;EAER,CAAC,EAAE,EAAE,CAAC;EAEN,IAAI,CAACN,iBAAiB,EAAE;IACtB,OAAO,IAAI;EACb,CAAC,MAAM;IACL,OACE,KAAC,QAAQ;MAAC,KAAK,EAAEF,KAAM;MAAA,UACrB,MAAC,gBAAgB;QAAA,WACb,CAACO,IAAI,IAAI,KAAC,SAAS;UAAC,OAAO,EAAEJ;QAAQ,EAAa,EAClDI,IAAI,IAAI;UAAA,WACN,KAAC,UAAU,KAAE,EACb,KAAC,SAAS,KAAG;QAAA,EACZ;MAAA;IAEY,EACV;EAEf;AACF"},"metadata":{},"sourceType":"module"}